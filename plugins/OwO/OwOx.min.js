(()=>{class t{constructor(t){const e={container:document.getElementsByClassName("OwO")[0],target:document.getElementsByTagName("textarea")[0],position:"down",width:"100%",maxHeight:"250px",api:"https://api.anotherhome.net/OwO/OwO.json"};for(let s in e)e.hasOwnProperty(s)&&!t.hasOwnProperty(s)&&(t[s]=e[s]);this.container=t.container,this.target=t.target,"up"===t.position&&this.container.classList.add("OwO-up");const s=new XMLHttpRequest;s.onreadystatechange=(()=>{4===s.readyState&&(s.status>=200&&s.status<300||304===s.status?(this.odata=JSON.parse(s.responseText),this.init(t)):console.log("OwO data request was unsuccessful: "+s.status))}),s.open("get",t.api,!0),s.send(null)}init(t){this.area=t.target,this.packages=Object.keys(this.odata);let e=`\n            <div class="OwO-logo">(〃∇〃)</div>\n            <div class="OwO-body" style="width: ${t.width}"><div class="OwO-jio"></div>`;for(let a=0;a<this.packages.length;a++){e+=`\n                <ul class="OwO-items OwO-items-${this.odata[this.packages[a]].type}" style="max-height: ${parseInt(t.maxHeight)-53+"px"};">`;var s=this.odata[this.packages[a]].type;let i=this.odata[this.packages[a]].container;for(let t=0;t<i.length;t++)e+="image"==s?`\n                    <li class="OwO-item" data-id="${i[t].data}" title="${i[t].text}">${i[t].icon}</li>`:`\n                    <li class="OwO-item" data-id="not-given" title="${i[t].text}">${i[t].icon}</li>`;e+="\n                </ul>"}e+='\n                <div class="OwO-bar">\n                    <ul class="OwO-packages">';for(let t=0;t<this.packages.length;t++)e+=`\n                        <li><span>${this.packages[t]}</span></li>`;e+="\n                    </ul>\n                </div>\n            </div>\n            ",this.container.innerHTML=e,this.logo=document.getElementsByClassName("OwO-logo")[0],this.logo.addEventListener("click",t=>{t.stopPropagation(),this.toggle()}),this.container.getElementsByClassName("OwO-body")[0].addEventListener("click",t=>{let e=null;if(t.target.classList.contains("OwO-item")?e=t.target:t.target.parentNode.classList.contains("OwO-item")&&(e=t.target.parentNode),e){const t=this.area.selectionEnd;let s=this.area.value;"not-given"==e.dataset.id?this.area.value=s.slice(0,t)+e.innerHTML+s.slice(t):this.area.value=s.slice(0,t)+e.dataset.id+s.slice(t),this.area.focus(),this.toggle()}}),this.packagesEle=this.container.getElementsByClassName("OwO-packages")[0];for(let t=0;t<this.packagesEle.children.length;t++)(e=>{this.packagesEle.children[t].addEventListener("click",t=>{t.stopPropagation(),this.tab(e)})})(t);this.tab(0)}toggle(){this.container.classList.contains("OwO-open")?this.container.classList.remove("OwO-open"):this.container.classList.add("OwO-open")}tab(t){const e=this.container.getElementsByClassName("OwO-items-show")[0];e&&e.classList.remove("OwO-items-show"),this.container.getElementsByClassName("OwO-items")[t].classList.add("OwO-items-show");const s=this.container.getElementsByClassName("OwO-package-active")[0];s&&s.classList.remove("OwO-package-active"),this.packagesEle.getElementsByTagName("li")[t].classList.add("OwO-package-active")}}"undefined"!=typeof module&&void 0!==module.exports?module.exports=t:window.OwO=t})();
window.onload = function(){
  emotion();
  //OwO设置
  Smilies = {
      dom: function(id) {
          return document.getElementById(id);
      },
      grin: function(tag) {
          tag = ' ' + tag + ' ';
          myField = this.dom("textarea");
          document.selection ? (myField.focus(), sel = document.selection.createRange(), sel.text = tag, myField.focus()) : this.insertTag(tag);
      },
      insertTag: function(tag) {
          myField = Smilies.dom("textarea");
          myField.selectionStart || myField.selectionStart == "0" ? (startPos = myField.selectionStart, endPos = myField.selectionEnd, cursorPos = startPos, myField.value = myField.value.substring(0, startPos) + tag + myField.value.substring(endPos, myField.value.length), cursorPos += tag.length, myField.focus(), myField.selectionStart = cursorPos, myField.selectionEnd = cursorPos) : (myField.value += tag, myField.focus());
      }
  }
}
function emotion(){
  if(document.getElementsByClassName("post-bq")){
    let comments = document.getElementsByClassName("post-bq");
    let i = 0;
    for(i;i<comments.length;i++){
        comments[i].innerHTML = comments[i].innerHTML.replace(/\@\((.*?)\)/g,'<img src="https://cdn.jsdelivr.net/gh/youranreus/R@v1.1.9/G/IMG/bq/$1.png" class="bq1">');
        comments[i].innerHTML = comments[i].innerHTML.replace(/\:\:(.*?)\:(.*?)\:\:/g,'<img src="https://cdn.jsdelivr.net/gh/youranreus/R@v1.1.8/W/bq/$1/$2.png" class="bq1">');
    }
  }
}
